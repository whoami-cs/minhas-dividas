# Gerenciador de Dívidas e Empréstimos com Supabase

Este é um painel financeiro para rastrear e gerenciar dívidas de cartão de crédito e empréstimos. Os dados são persistidos usando [Supabase](https://supabase.com/), uma alternativa de código aberto ao Firebase.

## Configuração do Supabase

Para fazer este aplicativo funcionar, você precisa criar um projeto no Supabase и configurar as tabelas do banco de dados.

### 1. Crie um Projeto Supabase

1.  Vá para [supabase.com](https://supabase.com/) e crie uma nova conta ou faça login.
2.  Clique em "New Project" e dê um nome ao seu projeto e gere uma senha segura para o banco de dados.
3.  Aguarde alguns minutos para que seu novo projeto seja configurado.

### 2. Obtenha suas Chaves de API

1.  No painel do seu projeto Supabase, vá para **Project Settings** (o ícone de engrenagem).
2.  Selecione a guia **API**.
3.  Você encontrará seu **Project URL** e sua chave **anon public** (Project API Key). Você precisará deles na Etapa 4.

### 3. Crie as Tabelas do Banco de Dados

1.  Vá para o **SQL Editor** no painel do seu projeto (o ícone de terminal).
2.  Clique em "+ New query".
3.  Copie e cole o seguinte código SQL para criar as tabelas `credit_card_debts` e `loans`, e em seguida clique em "RUN".

```sql
-- Habilita o RLS (Row Level Security) por padrão para novas tabelas
-- Isso é uma boa prática de segurança
alter default privileges in schema public grant select on tables to anon, authenticated;
alter default privileges in schema public grant insert on tables to anon, authenticated;
alter default privileges in schema public grant update on tables to anon, authenticated;
alter default privileges in schema public grant delete on tables to anon, authenticated;

-- Tabela para Dívidas de Cartão de Crédito
CREATE TABLE public.credit_card_debts (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc'::text, now()) NOT NULL,
    local TEXT NOT NULL,
    debt_date TEXT,
    original_value NUMERIC,
    current_value NUMERIC,
    growth_percentage NUMERIC,
    interest_value NUMERIC,
    last_update_date TEXT,
    next_month_estimate NUMERIC,
    offers TEXT,
    observation TEXT
);

-- Tabela para Empréstimos
CREATE TABLE public.loans (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc'::text, now()) NOT NULL,
    loan_date TEXT,
    creditor TEXT,
    loan_value NUMERIC,
    interest_value NUMERIC,
    final_value NUMERIC,
    total_installments INTEGER,
    paid_installments INTEGER,
    remaining_installments INTEGER,
    remaining_value NUMERIC,
    last_payment_date TEXT,
    status TEXT,
    observations TEXT,
    installments JSONB,
    balance_evolution JSONB
);

-- Permite que a chave anônima (anon key) leia e modifique as tabelas
-- Para um aplicativo de produção, você deve ter políticas de RLS mais rígidas
alter table public.credit_card_debts enable row level security;
alter table public.loans enable row level security;

create policy "Public access for all users"
on public.credit_card_debts for all
to anon, authenticated
using (true)
with check (true);

create policy "Public access for all users"
on public.loans for all
to anon, authenticated
using (true)
with check (true);

```

### 4. Popule os Dados Iniciais (Opcional)

**Importante:** Se você já executou um script de inserção anterior, limpe os dados das tabelas antes de executar este para evitar duplicatas e erros. Você pode fazer isso executando `DELETE FROM public.credit_card_debts;` e `DELETE FROM public.loans;` no SQL Editor.

Se você quiser começar com os dados de exemplo, execute o seguinte script SQL no **SQL Editor**:

```sql
-- Dados iniciais para Dívidas de Cartão de Crédito
INSERT INTO public.credit_card_debts (local, debt_date, original_value, current_value, growth_percentage, interest_value, last_update_date, next_month_estimate, offers, observation) VALUES
('Ourocard Visa Gold', '10/12/2024', 9239.70, 16064.65, 73.87, 6824.95, '10/11/2025', 16880.45, NULL, NULL),
('Nubank', '11/11/2024', 4616.38, 18296.36, 296.34, 13679.98, '10/11/2025', 20495.38, NULL, NULL),
('Santander Free Visa', '13/12/2024', 1807.14, 3372.00, 86.59, 1564.86, '10/11/2025', 3567.51, NULL, NULL),
('XP', '10/11/2024', 4349.14, 6028.18, 38.61, 1679.04, '10/11/2025', 0.00, '506,66 em 10/11 (-95%)', 'Não atualiza mais.'),
('Mercado Pago', '11/11/2024', 3500.00, 8136.15, 132.46, 4636.15, '04/10/2025', 8790.81, NULL, NULL),
('Sofisa', '15/11/2024', 4200.00, 6964.46, 65.82, 2764.46, '10/11/2025', 7264.25, NULL, NULL),
('Will Bank', '10/12/2024', 3100.80, 6201.60, 100.00, 3100.80, 'dd/mm/yyyy', 6198.77, NULL, 'Não atualiza mais.');

-- Dados iniciais para Empréstimos
INSERT INTO public.loans (loan_date, creditor, loan_value, interest_value, final_value, total_installments, paid_installments, remaining_installments, remaining_value, last_payment_date, status, observations, installments, balance_evolution) VALUES
('10/09/2024', 'SICOOB', 15416.77, 4107.52, 19949.04, 18, 15, 3, 3144.65, '05/11/2025', 'Ativo', 'Empréstimo Pessoal', 
'[{"paid": true, "days_late": 0, "discount": 0, "due_date": "10/09/2024", "history": "DEBITO AUTOMATICO EM C/C", "interest": 681.67, "late_fee": 0, "late_iof": 0, "paid_value": 1108.28, "amortization": 426.61, "parcel_number": 1, "payment_date": "10/09/2024", "installment_value": 1108.28}, {"paid": true, "days_late": 0, "discount": 0, "due_date": "10/10/2024", "history": "DEBITO AUTOMATICO EM C/C", "interest": 394.24, "late_fee": 0, "late_iof": 0, "paid_value": 1108.28, "amortization": 714.04, "parcel_number": 2, "payment_date": "10/10/2024", "installment_value": 1108.28}, {"paid": true, "days_late": 0, "discount": 0, "due_date": "11/11/2024", "history": "DEBITO AUTOMATICO EM C/C", "interest": 400.84, "late_fee": 0, "late_iof": 0, "paid_value": 1108.28, "amortization": 707.44, "parcel_number": 3, "payment_date": "11/11/2024", "installment_value": 1108.28}, {"paid": true, "days_late": 0, "discount": 0, "due_date": "10/12/2024", "history": "DEBITO AUTOMATICO EM C/C", "interest": 344.81, "late_fee": 0, "late_iof": 0, "paid_value": 1108.28, "amortization": 763.47, "parcel_number": 4, "payment_date": "10/12/2024", "installment_value": 1108.28}, {"paid": true, "days_late": 0, "discount": 1.92, "due_date": "10/01/2025", "history": "LIQUIDACAO PARCELA - DEBITO EM C/C", "interest": 348.15, "late_fee": 0, "late_iof": 0, "paid_value": 1106.36, "amortization": 760.13, "parcel_number": 5, "payment_date": "08/01/2025", "installment_value": 1108.28}, {"paid": true, "days_late": 0, "discount": 0, "due_date": "10/02/2025", "history": "DEBITO AUTOMATICO EM C/C", "interest": 348.32, "late_fee": 0, "late_iof": 0, "paid_value": 1108.28, "amortization": 759.96, "parcel_number": 6, "payment_date": "10/02/2025", "installment_value": 1108.28}, {"paid": true, "days_late": 0, "discount": 0, "due_date": "10/03/2025", "history": "DEBITO AUTOMATICO EM C/C", "interest": 276.26, "late_fee": 0, "late_iof": 0, "paid_value": 1108.28, "amortization": 832.02, "parcel_number": 7, "payment_date": "10/03/2025", "installment_value": 1108.28}, {"paid": true, "days_late": 0, "discount": 0, "due_date": "10/04/2025", "history": "DEBITO AUTOMATICO EM C/C", "interest": 283.64, "late_fee": 0, "late_iof": 0, "paid_value": 1108.28, "amortization": 824.64, "parcel_number": 8, "payment_date": "10/04/2025", "installment_value": 1108.28}, {"paid": true, "days_late": 0, "discount": 0, "due_date": "12/05/2025", "history": "DEBITO AUTOMATICO EM C/C", "interest": 269.76, "late_fee": 0, "late_iof": 0, "paid_value": 1108.28, "amortization": 838.52, "parcel_number": 9, "payment_date": "12/05/2025", "installment_value": 1108.28}, {"paid": true, "days_late": 0, "discount": 3.83, "due_date": "10/06/2025", "history": "LIQUIDACAO PARCELA - DEBITO EM C/C", "interest": 222.84, "late_fee": 0, "late_iof": 0, "paid_value": 1104.45, "amortization": 885.44, "parcel_number": 10, "payment_date": "06/06/2025", "installment_value": 1108.28}, {"paid": true, "days_late": 0, "discount": 0, "due_date": "10/07/2025", "history": "PAGAMENTO PARCIAL + DEBITO", "interest": 221.22, "late_fee": 27.18, "late_iof": 0.36, "paid_value": 1135.82, "amortization": 873.7, "parcel_number": 11, "payment_date": "14/07/2025", "installment_value": 1108.28}, {"paid": true, "days_late": 0, "discount": 0, "due_date": "11/08/2025", "history": "DEBITO AUTOMATICO EM C/C", "interest": 196.06, "late_fee": 0, "late_iof": 0, "paid_value": 1108.28, "amortization": 912.22, "parcel_number": 12, "payment_date": "11/08/2025", "installment_value": 1108.28}, {"paid": true, "days_late": 0, "discount": 0, "due_date": "10/09/2025", "history": "DEBITO AUTOMATICO EM C/C", "interest": 159.65, "late_fee": 0, "late_iof": 0, "paid_value": 1108.28, "amortization": 948.63, "parcel_number": 13, "payment_date": "10/09/2025", "installment_value": 1108.28}, {"paid": true, "days_late": 0, "discount": 0, "due_date": "10/10/2025", "history": "DEBITO AUTOMATICO EM C/C", "interest": 134.71, "late_fee": 0, "late_iof": 0, "paid_value": 1108.28, "amortization": 973.57, "parcel_number": 14, "payment_date": "10/10/2025", "installment_value": 1108.28}, {"paid": true, "days_late": 0, "discount": 4.78, "due_date": "10/11/2025", "history": "LIQUIDACAO PARCELA - DEBITO EM C/C", "interest": 112.79, "late_fee": 0, "late_iof": 0, "paid_value": 1103.5, "amortization": 995.49, "parcel_number": 15, "payment_date": "05/11/2025", "installment_value": 1108.28}, {"paid": false, "days_late": 0, "discount": 0, "due_date": "10/12/2025", "history": "", "interest": 0, "late_fee": 0, "late_iof": 0, "paid_value": null, "amortization": 0, "parcel_number": 16, "payment_date": null, "installment_value": 1108.28}, {"paid": false, "days_late": 0, "discount": 0, "due_date": "12/01/2026", "history": "", "interest": 0, "late_fee": 0, "late_iof": 0, "paid_value": null, "amortization": 0, "parcel_number": 17, "payment_date": null, "installment_value": 1108.28}, {"paid": false, "days_late": 0, "discount": 0, "due_date": "10/02/2026", "history": "", "interest": 0, "late_fee": 0, "late_iof": 0, "paid_value": null, "amortization": 0, "parcel_number": 18, "payment_date": null, "installment_value": 1108.28}]',
'[{"type": "D", "debit": 15416.77, "credit": 0, "balance": 15416.77, "history": "LIBERAÇÃO DA OPERAÇÃO", "launch_date": "22/07/2024", "reference_date": "22/07/2024"}, {"type": "D", "debit": 120.53, "credit": 0, "balance": 15537.3, "history": "APROPRIAÇÃO DE JUROS", "launch_date": "31/07/2024", "reference_date": "31/07/2024"}, {"type": "D", "debit": 422.43, "credit": 0, "balance": 15959.73, "history": "APROPRIAÇÃO DE JUROS", "launch_date": "30/08/2024", "reference_date": "31/08/2024"}, {"type": "D", "debit": 138.71, "credit": 0, "balance": 16098.44, "history": "APROPRIAÇÃO DE JUROS", "launch_date": "10/09/2024", "reference_date": "10/09/2024"}, {"type": "C", "debit": 0, "credit": 1108.28, "balance": 14990.16, "history": "LIQUIDAÇÃO NA OPERAÇÃO", "launch_date": "10/09/2024", "reference_date": "10/09/2024"}, {"type": "D", "debit": 261.68, "credit": 0, "balance": 15251.84, "history": "APROPRIAÇÃO DE JUROS", "launch_date": "30/09/2024", "reference_date": "30/09/2024"}, {"type": "D", "debit": 132.56, "credit": 0, "balance": 15384.4, "history": "APROPRIAÇÃO DE JUROS", "launch_date": "10/10/2024", "reference_date": "10/10/2024"}, {"type": "C", "debit": 0, "credit": 1108.28, "balance": 14276.12, "history": "LIQUIDAÇÃO NA OPERAÇÃO", "launch_date": "10/10/2024", "reference_date": "10/10/2024"}, {"type": "D", "debit": 261.79, "credit": 0, "balance": 14537.91, "history": "APROPRIAÇÃO DE JUROS", "launch_date": "31/10/2024", "reference_date": "31/10/2024"}, {"type": "D", "debit": 139.05, "credit": 0, "balance": 14676.96, "history": "APROPRIAÇÃO DE JUROS", "launch_date": "11/11/2024", "reference_date": "11/11/2024"}, {"type": "C", "debit": 0, "credit": 1108.28, "balance": 13568.68, "history": "LIQUIDAÇÃO NA OPERAÇÃO", "launch_date": "11/11/2024", "reference_date": "11/11/2024"}, {"type": "D", "debit": 224.93, "credit": 0, "balance": 13793.61, "history": "APROPRIAÇÃO DE JUROS", "launch_date": "29/11/2024", "reference_date": "30/11/2024"}, {"type": "D", "debit": 119.88, "credit": 0, "balance": 13913.49, "history": "APROPRIAÇÃO DE JUROS", "launch_date": "10/12/2024", "reference_date": "10/12/2024"}, {"type": "C", "debit": 0, "credit": 1108.28, "balance": 12805.21, "history": "LIQUIDAÇÃO NA OPERAÇÃO", "launch_date": "10/12/2024", "reference_date": "10/12/2024"}, {"type": "D", "debit": 234.82, "credit": 0, "balance": 13040.03, "history": "APROPRIAÇÃO DE JUROS", "launch_date": "31/12/2024", "reference_date": "31/12/2024"}, {"type": "D", "debit": 90.59, "credit": 0, "balance": 13130.62, "history": "APROPRIAÇÃO DE JUROS CONTRATUAIS", "launch_date": "08/01/2025", "reference_date": "08/01/2025"}, {"type": "C", "debit": 0, "credit": 1106.36, "balance": 12024.26, "history": "LIQUIDAÇÃO NA OPERAÇÃO", "launch_date": "08/01/2025", "reference_date": "08/01/2025"}, {"type": "D", "debit": 241.71, "credit": 0, "balance": 12265.97, "history": "APROPRIAÇÃO DE JUROS CONTRATUAIS", "launch_date": "31/01/2025", "reference_date": "31/01/2025"}, {"type": "D", "debit": 106.61, "credit": 0, "balance": 12372.58, "history": "APROPRIAÇÃO DE JUROS CONTRATUAIS", "launch_date": "10/02/2025", "reference_date": "10/02/2025"}, {"type": "C", "debit": 0, "credit": 1108.28, "balance": 11264.3, "history": "LIQUIDAÇÃO NA OPERAÇÃO", "launch_date": "10/02/2025", "reference_date": "10/02/2025"}, {"type": "D", "debit": 176.83, "credit": 0, "balance": 11441.13, "history": "APROPRIAÇÃO DE JUROS CONTRATUAIS", "launch_date": "28/02/2025", "reference_date": "28/02/2025"}, {"type": "D", "debit": 99.43, "credit": 0, "balance": 11540.56, "history": "APROPRIAÇÃO DE JUROS CONTRATUAIS", "launch_date": "10/03/2025", "reference_date": "10/03/2025"}, {"type": "C", "debit": 0, "credit": 1108.28, "balance": 10432.28, "history": "LIQUIDAÇÃO NA OPERAÇÃO", "launch_date": "10/03/2025", "reference_date": "10/03/2025"}, {"type": "D", "debit": 191.31, "credit": 0, "balance": 10623.59, "history": "APROPRIAÇÃO DE JUROS CONTRATUAIS", "launch_date": "31/03/2025", "reference_date": "31/03/2025"}, {"type": "D", "debit": 92.33, "credit": 0, "balance": 10715.92, "history": "APROPRIAÇÃO DE JUROS CONTRATUAIS", "launch_date": "10/04/2025", "reference_date": "10/04/2025"}, {"type": "C", "debit": 0, "credit": 1108.28, "balance": 9607.64, "history": "LIQUIDAÇÃO NA OPERAÇÃO", "launch_date": "10/04/2025", "reference_date": "10/04/2025"}, {"type": "D", "debit": 167.72, "credit": 0, "balance": 9775.36, "history": "APROPRIAÇÃO DE JUROS CONTRATUAIS", "launch_date": "30/04/2025", "reference_date": "30/04/2025"}, {"type": "D", "debit": 102.04, "credit": 0, "balance": 9877.4, "history": "APROPRIAÇÃO DE JUROS CONTRATUAIS", "launch_date": "12/05/2025", "reference_date": "12/05/2025"}, {"type": "C", "debit": 0, "credit": 1108.28, "balance": 8769.12, "history": "LIQUIDAÇÃO NA OPERAÇÃO", "launch_date": "12/05/2025", "reference_date": "12/05/2025"}, {"type": "D", "debit": 145.37, "credit": 0, "balance": 8914.49, "history": "APROPRIAÇÃO DE JUROS CONTRATUAIS", "launch_date": "30/05/2025", "reference_date": "31/05/2025"}, {"type": "D", "debit": 46.4, "credit": 0, "balance": 8960.89, "history": "APROPRIAÇÃO DE JUROS CONTRATUAIS", "launch_date": "06/06/2025", "reference_date": "06/06/2025"}, {"type": "C", "debit": 0, "credit": 1104.45, "balance": 7856.44, "history": "LIQUIDAÇÃO NA OPERAÇÃO", "launch_date": "06/06/2025", "reference_date": "06/06/2025"}, {"type": "D", "debit": 164.87, "credit": 0, "balance": 8021.31, "history": "APROPRIAÇÃO DE JUROS CONTRATUAIS", "launch_date": "30/06/2025", "reference_date": "30/06/2025"}, {"type": "D", "debit": 69.71, "credit": 0, "balance": 8091.02, "history": "APROPRIAÇÃO DE JUROS CONTRATUAIS", "launch_date": "10/07/2025", "reference_date": "10/07/2025"}, {"type": "C", "debit": 0, "credit": 13.36, "balance": 8077.66, "history": "LIQUIDAÇÃO NA OPERAÇÃO", "launch_date": "10/07/2025", "reference_date": "10/07/2025"}, {"type": "D", "debit": 27.18, "credit": 0, "balance": 8104.84, "history": "APROPRIAÇÃO ENCARGOS MORATORIOS", "launch_date": "14/07/2025", "reference_date": "14/07/2025"}, {"type": "C", "debit": 0, "credit": 1122.1, "balance": 6982.74, "history": "LIQUIDAÇÃO NA OPERAÇÃO", "launch_date": "14/07/2025", "reference_date": "14/07/2025"}, {"type": "D", "debit": 128.05, "credit": 0, "balance": 7110.79, "history": "APROPRIAÇÃO DE JUROS CONTRATUAIS", "launch_date": "31/07/2025", "reference_date": "31/07/2025"}, {"type": "D", "debit": 68.01, "credit": 0, "balance": 7178.8, "history": "APROPRIAÇÃO DE JUROS CONTRATUAIS", "launch_date": "11/08/2025", "reference_date": "11/08/2025"}, {"type": "C", "debit": 0, "credit": 1108.28, "balance": 6070.52, "history": "LIQUIDAÇÃO NA OPERAÇÃO", "launch_date": "11/08/2025", "reference_date": "11/08/2025"}, {"type": "D", "debit": 105.98, "credit": 0, "balance": 6176.5, "history": "APROPRIAÇÃO DE JUROS CONTRATUAIS", "launch_date": "29/08/2025", "reference_date": "31/08/2025"}, {"type": "D", "debit": 53.67, "credit": 0, "balance": 6230.17, "history": "APROPRIAÇÃO DE JUROS CONTRATUAIS", "launch_date": "10/09/2025", "reference_date": "10/09/2025"}, {"type": "C", "debit": 0, "credit": 1108.28, "balance": 5121.89, "history": "LIQUIDAÇÃO NA OPERAÇÃO", "launch_date": "10/09/2025", "reference_date": "10/09/2025"}, {"type": "D", "debit": 89.41, "credit": 0, "balance": 5211.3, "history": "APROPRIAÇÃO DE JUROS CONTRATUAIS", "launch_date": "30/09/2025", "reference_date": "30/09/2025"}, {"type": "D", "debit": 45.3, "credit": 0, "balance": 5256.6, "history": "APROPRIAÇÃO DE JUROS CONTRATUAIS", "launch_date": "10/10/2025", "reference_date": "10/10/2025"}, {"type": "C", "debit": 0, "credit": 1108.28, "balance": 4148.32, "history": "LIQUIDAÇÃO NA OPERAÇÃO", "launch_date": "10/10/2025", "reference_date": "10/10/2025"}, {"type": "D", "debit": 76.07, "credit": 0, "balance": 4224.39, "history": "APROPRIAÇÃO DE JUROS CONTRATUAIS", "launch_date": "31/10/2025", "reference_date": "31/10/2025"}, {"type": "D", "debit": 18.32, "credit": 0, "balance": 4242.71, "history": "APROPRIAÇÃO DE JUROS CONTRATUAIS", "launch_date": "05/11/2025", "reference_date": "05/11/2025"}, {"type": "C", "debit": 0, "credit": 1103.5, "balance": 3139.21, "history": "LIQUIDAÇÃO NA OPERAÇÃO", "launch_date": "05/11/2025", "reference_date": "05/11/2025"}, {"type": "D", "debit": 5.44, "credit": 0, "balance": 3144.65, "history": "APROPRIAÇÃO DE JUROS CONTRATUAIS", "launch_date": "07/11/2025", "reference_date": "07/11/2025"}]'
);

```

### 5. Configure suas Credenciais no Aplicativo

1.  Abra o arquivo `src/environments/environment.ts`.
2.  Substitua `'YOUR_SUPABASE_URL'` pela URL do seu projeto.
3.  Substitua `'YOUR_SUPABASE_ANON_KEY'` pela sua chave anônima (anon public).
4.  Salve o arquivo. Agora o aplicativo deve ser capaz de se conectar ao seu banco de dados Supabase.

```typescript
// src/environments/environment.ts
export const environment = {
  production: false,
  supabaseUrl: 'YOUR_SUPABASE_URL', // Cole sua URL aqui
  supabaseKey: 'YOUR_SUPABASE_ANON_KEY', // Cole sua chave anônima aqui
};
```
